<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
  <meta name="theme-color" content="#121212" />
  <meta name="description" content="Play the classic Mafia party game with friends" />
  
  <!-- PWA Meta Tags -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Mafia Night">
  
  <!-- Basic Icons -->
  <link rel="apple-touch-icon" href="/pwa/icon-192x192.png">
  <link rel="manifest" href="/manifest.json" />
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <!-- Custom styles -->
  <link rel="stylesheet" href="/fonts.css">
  
  <title>Mafia Game Night</title>
  
  <style>
    /* CSS Variables for safe areas */
    :root {
      --sat: env(safe-area-inset-top, 44px);
      --sab: env(safe-area-inset-bottom, 34px);
      --sal: env(safe-area-inset-left, 0px);
      --sar: env(safe-area-inset-right, 0px);
      --nav-height: 70px; /* Approximate height of the bottom navigation */
    }

    /* Hard reset margins and default styles */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overscroll-behavior: none; /* Prevent pull-to-refresh */
      -webkit-overflow-scrolling: touch;
      -webkit-tap-highlight-color: transparent;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: #0A1929;
      color: #E2E8F0;
      overflow-x: hidden; /* Prevent horizontal scrolling */
      /* Ensure content is properly padded for mobile browsers */
      padding-bottom: var(--nav-height); /* For bottom navigation */
    }
    
    /* Fix root container positioning */
    #root {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      height: 100%;
      /* Ensure scrollable content doesn't overlap with bottom nav */
      padding-bottom: var(--sab, 0px);
      box-sizing: border-box;
      position: relative;
      overflow-x: hidden;
    }
    
    /* Add padding for PWA mode */
    @media (display-mode: standalone), (display-mode: fullscreen) {
      body {
        padding-top: var(--sat, 0px);
      }
      
      /* Ensure bottom nav stays in place in PWA mode */
      #bottom-navigation, [id="bottom-navigation"] {
        position: fixed !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        z-index: 9999 !important;
        padding-bottom: var(--sab, 0) !important;
      }
    }
    
    /* Loading spinner style */
    .loading-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #0A1929;
      z-index: 9999;
    }
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 3px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: #C0392B; /* Match Mafia theme */
      animation: spin 1s ease-in-out infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Fix for fixed positioned elements */
    .fixed-bottom {
      position: fixed !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      z-index: 999;
    }
  </style>
</head>
<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root">
    <!-- Loading spinner shown before app loads -->
    <div class="loading-container">
      <div class="loading-spinner"></div>
    </div>
  </div>
  
  <!-- Service worker registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/service-worker.js')
          .then(function(registration) {
            console.log('ServiceWorker registration successful');
          })
          .catch(function(err) {
            console.log('ServiceWorker registration failed: ', err);
          });
      });
    }
    
    // Fix for mobile browsers hiding nav bar on scroll
    window.addEventListener('scroll', function() {
      // Force-show the bottom navigation even during scroll
      const bottomNav = document.getElementById('bottom-navigation');
      if (bottomNav) {
        bottomNav.style.transform = 'translateY(0)';
        bottomNav.style.visibility = 'visible';
        bottomNav.style.opacity = '1';
      }
    });
    
    // Prevent pull-to-refresh on mobile
    document.body.addEventListener('touchmove', function(e) {
      if (e.touches.length > 1 || document.body.scrollTop === 0) {
        // If already at the top and still pulling down
        if (e.cancelable) e.preventDefault();
      }
    }, { passive: false });
    
    // Fix for iOS height calculation 
    function setViewportHeight() {
      let vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    setViewportHeight();
    
    window.addEventListener('resize', setViewportHeight);
    window.addEventListener('orientationchange', setViewportHeight);
  </script>
</body>
</html> 